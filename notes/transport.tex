% Created 2016-02-17 Wed 15:15
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fixltx2e}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage{tikz}
\usepackage{fancyhdr}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\renewcommand\vec{\mathbf}
\newcommand\leftidx[3]{{\vphantom{#2}}#1#2#3}
\newenvironment{example}[1]{\vspace{0.2in}\hrule\vspace{0.1in}\noindent\emph{Example:} #1 \\}{\vspace{0.1in}\hrule\vspace{0.2in}}
\pagestyle{fancyplain}
\cfoot{{\it ENGY 5050, Nuclear Reactor Physics, UMass Lowell}}
\author{Justin Pounders}
\date{\today}
\title{Neutron Transport}
\hypersetup{
 pdfauthor={Justin Pounders},
 pdftitle={Neutron Transport},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 24.5.1 (Org mode 8.3.2)}, 
 pdflang={English}}
\begin{document}

\maketitle
\tableofcontents

At this point we have characterized neutron-nucleus interactions and described the physics of a neutron slowing down from high (fission) energies to low (thermal) energies in the presence of moderators and resonance absorbers.  We will now proceed to a full description of neutron transport, the goal of which is to describe how neutrons are distributed through space and energy as a function of time.

\section{Fundamental Concepts and Variables}
\label{sec:orgheadline4}
We know that a scattering reaction will tend to change the kinetic energy of a neutron and the direction in which it is traveling.  Thus our attempt to describe the distribution of neutrons must take into account space (where neutrons are), energy (how fast they are moving), angle (in what direction they are moving) and time.  This collection of independent variables is called the \emph{phase space} of neutron transport.

The space parameter will be denoted by the variable \(\vec{r}\).  While it is possible to represent this vector in any number coordinate systems, we will focus on Cartesian systems so that space can be represented by vectors of the form \(\vec{r} = x\vec{i} + y\vec{j} + z \vec{k}\).  In three-dimensional (Cartesian) space the differential space element is a differential volume \(dV = dx dy dz\).

A neutrons direction (or angle) at a given point is given by the unit vector \(\vec{\Omega}\).  The definition and properties of \(\vec{\Omega}\) is given in the ``Mathematical Odds and Ends'' appendix accompanying these notes.  The angle \(\vec{\Omega}\) can be described in terms of its projections along each of three Cartesian coordinate axes, \(\vec{\Omega} = \Omega_x \vec{i} + \Omega_y \vec{j} + \Omega_z \vec{k}\), or in terms of the polar and azimuthal angles \(\theta\) and \(\varphi\), \(\vec{\Omega} = \sin\theta \cos\varphi \vec{i} + \sin\theta \sin\varphi \vec{j} + \cos\theta \vec{k}\).  In three dimensions the differential \emph{solid angle} is \(d\vec{\Omega} = \sin\theta d\varphi d\theta\).

\subsection{Neutron Density}
\label{sec:orgheadline1}
Because there is such a high density of neutrons in a reactor and their collisions are probabilistic, it is infeasible to determine the location and velocity of every single neutron, nor would such an abundance of information be particularly useful.  Instead we will attempt to determine the \emph{expected} number of a neutrons within differential space, angle and energy elements as a function of time:
\begin{align}
  n(\vec{r},\vec{\Omega},E,t) dV d\vec{\Omega} dt.
\end{align}
The function \(n(\vec{r},\vec{\Omega},E,t)\) in this quantity is the \emph{neutron angular density}.  We may also define the \emph{neutron scalar density} as the expected number of neutrons in all directions, \(n(\vec{r},E,t) = \int_{4\pi} n(\vec{r},\vec{\Omega},E,t) d\vec{\Omega}\).

\subsection{Neutron Flux}
\label{sec:orgheadline2}
We know that the reaction rate density (i.e., the number of neutron interactions per unit volume per unit time) is the product of the nuclelar density, the microscopic cross section for the reaction, the neutron speed and the neutron density.  The product of the first two parameters is called the macroscopic cross section, while the product of the latter two parameters is called the neutron flux.  If we write the neutron flux to explicitly include variation with respect to angle then we have the \emph{angular neutron flux}, \(\psi(\vec{r},\vec{\Omega},E,t) = v(E)n(\vec{r},\vec{\Omega},E,t)\).  If we integrate over all angles then we have the \emph{scalar neutron flux}, \(\phi(\vec{r},E,t) = \int_{4\pi} \psi(\vec{r},\vec{\Omega},E,t)\).

Knowing the angular and scalar fluxes is valuable because it enables us to compute reaction rates, including the rate at which energy is produced from fission reactions.  An intuitive interpretation of these functions, however, is not immediately evident.  Recall that the neutron \emph{speed} is the differential path length divided by a differential unit of time.  The product of the neutron density with speed (i.e., flux) is therefore the \emph{total path length} traversed by all neutrons per unit volume per unit time.  Thus multiplying flux by the macroscopic cross section (probability of interaction per unit path length) gives us interactions per unit volume per unit time.  The \emph{angular} flux is the total path length of all the neutrons moving along a given direction; the \emph{scalar} flux is the total path length of all the neutrons regardless of direction.

\subsection{Neutron Current}
\label{sec:orgheadline3}
If we multiply the angular neutron density by the vector velocity then we get the \emph{angular neutron current}: \(\vec{J}(\vec{r},\vec{\Omega},E,t) = \vec{v}(\vec{\Omega},E) n(\vec{r},\vec{\Omega},E,t)\).  Integrating this variable over all angles provides a vector-valued quantity which is usually just called \emph{neutron current}: \(\vec{J}(\vec{r},E,t) = \int_{4\pi} \vec{v}(\vec{\Omega},E) n(\vec{r},\vec{\Omega},E,t) d\vec{\Omega}\).  Noting \(\vec{v}(\vec{\Omega},E) = \vec{\Omega}v(E)\) permits writing the current in terms of the angular neutron flux.

The neutron current is a useful quantity because it allows us to calculate the rate at which neutrons are ``flowing'' through a surface.  In particular, the rate at which neutrons with energy \(E\) are crossing a differential surface with area \(dA\) and unit normal vector \(\vec{n}\) is given by
\begin{align}
  dA \left( \vec{n} \cdot \vec{J}(\vec{r},E,t) \right).
\end{align}

\begin{table}
  \centering
  \caption{Basic quantities in neutron transport}
  \begin{tabular}{ll}
  \hline
  Angular density & $n(\vec{r},\vec{\Omega},E,t)$ \\
  Angular flux & $\psi(\vec{r},\vec{\Omega},E,t) = v(E) n(\vec{r},\vec{\Omega},E,t)$ \\
  Scalar flux & $\phi(\vec{r},E,t) = \int_{4\pi} \psi(\vec{r},\vec{\Omega},E,t) d\vec{\Omega}$ \\
  Current & $\vec{J}(\vec{r},E,t) = \int_{4\pi} \vec{\Omega} \psi(\vec{r},\vec{\Omega},E,t)$ \\
  \hline
  \end{tabular}
\end{table}

\section{The Transport Equation}
\label{sec:orgheadline10}
A transport equation for neutrons can be obtained by performing a neutron balance about an element \(dV d\vec{\Omega} dE dt\) in phase space.  We make the following assumptions
\begin{enumerate}
\item Neutrons travel in straight line between collisions.
\item Neutron exists as points in space, with negligible size.
\item Neutron-neutron interactions can be neglected.
\item Neutron-nucleus interactions occur instantaneously.
\item The material is isotropic.
\item When scattering, the deflection of a neutron's trajectory from \(\vec{\Omega}'\) to \(\vec{\Omega}\) is a function of the cosine of the angle between the original and final unit directions, i.e. \(\vec{\Omega}' \cdot \vec{\Omega}\).
\end{enumerate}

We will make several additional assumptions at this point that, while not necessary, are very accurate and lead to a simpler form of the transport equation.
\begin{enumerate}
\item Fission neutrons are emitted isotropically in the LAB.
\item The average number fission neutrons is independent of the energy of the neutron that caused the fission.
\item The only reaction that generates neutrons if fission.
\end{enumerate}
In reality, assumptions 2 and 3 will lead to small errors in the transport solution, but typically the cross sections to account for these effects implicitly.  Specifically the quantity \(\nu\Sigma_f(E)\) is usually treated as a single quantity so that the energy variation of \(\nu\) is embedded in \(\Sigma_f(E)\).  With regards to assumption 3, some highly excited heavy nuclei may exist two or three neutrons, leading to (n,2n) or (n,3n) reactions.  The additional neutrons in this case can be accounted for by normalizing the overall scattering to the average number of neutrons emitted, which will be very close to one.

The final form of the transport equation given these assumptions is
\begin{align}
  \frac{1}{v} \frac{\partial\psi}{\partial t}
  + \vec{\Omega} \cdot \nabla\psi
  + \Sigma \psi
  &= \int_0^\infty dE' \int_{4\pi} \Sigma_s(\vec{r},E' \rightarrow E, \vec{\Omega}'\cdot\vec{\Omega} \psi(\vec{r},\vec{\Omega}',E',t) \\
  &+ \frac{\chi(E)}{4\pi} \int_0^\infty dE' \int_{4\pi} \nu\Sigma_f(\vec{r},E') \psi(\vec{r},\vec{\Omega}',E',t)
  + q(\vec{r},\vec{\Omega},E,t).
  \label{eq::transportEqn}
\end{align}
For completeness, consider the transport equation to be solved for a region \(V\) so that \(\vec{r} \in V\).  We will also take \(E \in [0, \infty]\), although in practice a maximum and minimum energy are adopted so that the flux is negligible outside of the that interval.

As with any mathematical model, we must consider under what conditions our transport equation has a viable solution.  To answer this question rigorously one should turn to the tools and theory of mathematics.  Arguments based on physics intuition, however, will lead largely to the same conclusions given sufficient clarity of thought.  We will therefore focus on intuitive arguments.

\subsection{Boundary Conditions}
\label{sec:orgheadline5}
As with any differential equation, we must supply appropriate boundary conditions.  Let us presently denote the boundary of \(V\) by \(\partial V\).  When solving the neutron transport equation for the angular flux, the boundary condition specifies the number of neutrons \emph{entering} the system.  There are several ways to provide this boundary source.  The simplest is the \emph{fixed flux} boundary condition, which has the following form:
\begin{align}
  \psi(\vec{r},\vec{\Omega},E,t) = \psi_\text{inc}(\vec{r},\vec{\Omega},E,t)
\end{align}
where \(\psi_\text{inc}\) is given a function for \(\vec{r} \in \partial V\) and \(\vec{\Omega} \cdot \vec{n} < 0\) with \(\vec{n}\) the outward unit normal vector on the surface \(\partial V\).  If \(\psi_\text{inc} = 0\) then we have the \emph{vacuum} condition, which means that there are no incoming neutrons.

Most reactors exhibit a high degree of spatial repetition, fuel rods in an assembly lattice being the prime example.  A common approximation in modeling a single fuel rod is to assume that the lattice repeats infinitely in the radial directions.  Thus each fuel rod looks like every other fuel rod.  This form of symmetry can be exploited by placing mirror boundary conditions known as \emph{specular reflection} between the rods.  In this type of reflection we have
\begin{align}
  \psi(\vec{r},\vec{\Omega},E,t) = \psi(\vec{r},\vec{\Omega}',E,t)
\end{align}
where \(\vec{\Omega}\) is the incoming direction corresponding to mirror reflection of \(\vec{\Omega}'\) outgoing direction.  Mathematically this means \(\vec{\Omega} \cdot \vec{n} = - \vec{\Omega}' \cdot \vec{n}\) and \(\left(\vec{\Omega} \times \vec{\Omega}'\right) \cdot \vec{n} = 0\).

Vaccum and specular reflection boundary conditions are by far the most common.  Other possible boundary conditions are \emph{white reflection}, in which outgoing neutrons are distributed uniformly across all incoming directions, and periodic boundary conditions, which account for translational and rotational symmetry.

\subsection{Initial Condition}
\label{sec:orgheadline6}
Because the transport equation, as it is written, is time-dependent, we must also supply an initial condition.  The initial condition is simply
\begin{align}
  \psi(\vec{r},\vec{\Omega},E,0) = \psi_0(\vec{r},\vec{\Omega},E)
\end{align}
with \(\psi_0\) a given function for \(\vec{r} \in V\).

\subsection{Existence of a Steady-State Solution}
\label{sec:orgheadline7}
We often want to determine the ``steady-state'' flux solution for a system that is in some form of equilibrium.  In general, Eq. \eqref{eq::transportEqn} may or may not have a steady-state solution.  The complicating factor is fission.  If more neutrons are begin created from fission than lost by all capture and leakage, then the chain reaction will drive the neutron population perpetually upward.  If the opposite is true then the neutron population will rapidly decrease.  Thus steady-state is only obtained when there is a \emph{precise} balance between production and loss.  

If neutron loss (by leakage or capture) is much more likely than neutron production by fission (called a sub-critical configuration), then we will have a steady-state solution as long as the external source term, \(q\) is non-zero.  These problems are called \emph{fixed-source} problems, and include accelerator systems, radiation shielding, and sub-critical reactors as a characteristic examples.  If \(q=0\) then there will be only the trivial solution.

In reactor design and analysis, however, we frequently want to determine the steady-state power distribution corresponding to a ``critical reactor'' in which neutron production is exactly balanced by neutron loss.  In this case the external source of neutrons, \(q(\vec{r},\vec{\Omega},E,t)\), is either zero or negligible, and the transport equation becomes
\begin{align}
  \vec{\Omega} \cdot \nabla\psi(\vec{r},\vec{\Omega},E)
  + \Sigma(\vec{r},\vec{\Omega}) \psi(\vec{r},\vec{\Omega},E)
  &= \int_0^\infty dE' \int_{4\pi} \Sigma(\vec{r},E' \rightarrow E, \vec{\Omega}'\cdot\vec{\Omega}) \psi(\vec{r},\vec{\Omega}',E') \\
  &+ \frac{\chi(E)}{4\pi} \int_0^\infty dE' \int_{4\pi} \nu\Sigma_f(\vec{r},E') \psi(\vec{r},\vec{\Omega}',E').
  \label{eq::ssTransportEqn}
\end{align}
As it is written, Eq. \eqref{eq::ssTransportEqn} will practically \emph{never} have a solution.  Any imbalance in the transport equation, whether due to the physical configuration, cross section uncertainties, or numerical error, will cause the equation to be unsolvable because no corresponding steady-state solution exists.  Solvability exists at the infinitesimal point where all of the cross section values align to produce a precisely balanced system.  Numerically there is no hope in finding this magical point.

We may not be able to model the reactor precisely enough to determine a steady-state solution, but we can look for a solution that is ``close'' to a steady-state solution.  This is accomplished by introducing a scaling factor, typically on the fission term.  Calling this scaling factor \(\lambda\) the transport equation becomes
\begin{align}
  \vec{\Omega} \cdot \nabla\psi(\vec{r},\vec{\Omega},E)
  + \Sigma(\vec{r},E) \psi(\vec{r},\vec{\Omega},E)
  &= \int_0^\infty dE' \int_{4\pi} \Sigma_s(\vec{r},E' \rightarrow E, \vec{\Omega}'\cdot\vec{\Omega}) \psi(\vec{r},\vec{\Omega}',E') \\
  &+ \lambda\frac{\chi(E)}{4\pi} \int_0^\infty dE' \int_{4\pi} \nu\Sigma_f(\vec{r},E') \psi(\vec{r},\vec{\Omega}',E').
  \label{eq::eigTransportEqn}
\end{align}
The factor \(\lambda\) adds a ``knob'' so that we can dial-in a solution that approximates the reactor's steady-state, given that our naive numerical model has no chance of being precise enough.  The closer \(\lambda\) is to one, the closer we are to a legitimate steady-state solution.  It is common to call the inverse of \(\lambda\) the \emph{effective multiplication factor}, or \(k_\text{eff} = \lambda^{-1}\), because it represents the rate at which the neutron population would be increasing (or multiplying) if this system were ``real.''  Inspection of Eq. \eqref{eq::eigTransportEqn} reveals that it is in fact a generalized eigenvalue problem with \(\lambda\) the eigenvalue.  The equation may be massaged into a traditional eigenvalue problem with \(k_\text{eff}\) the eigenvalue.  We will discuss this further at a later time.

A final practical consideration is that the eigenvalue form of the transport equation is homogeneous and linear in the angular flux.  This means that the angular flux can be arbitrarily scaled and the solution remains valid.  (This is the typical behavior of eigenvalue problems.)  Thus to determine a \emph{unique} solution, we must provide an additional constraint.  Typically the total reactor power fulfills this requirement.

\subsection{What just happened?}
\label{sec:orgheadline8}
It is very easy at this point to be temporarily blinded by the sudden onslaught of mathematical technicality that has attacked our transport equation.  It is worth a moments time to consider what happens in a real reactor so that we remain somewhat oriented with respect to reality.  If you have not been previously exposed to reactor physics or reactor operations (or have not paid attention to such discussions) then some of the following must be taken initially on faith.

First, in the previous section we painted a very bleak picture of a steady-state reactor being balanced on a precipice between explosion and stagnation.  Commercial reactors, however, are designed to inherently be quite stable beasts.  One of the most important stabilizing factors has already been introduced in these notes, which is the Doppler broadening of capture cross sections.  If a reactor is generating more neutrons from fission than are being lost, then the neutron population will increase and the fission reaction rate will follow in lock-step.  As power increases temperature will rise.  You have seen that increasing the temperature of an isotope with capture resonance will increase the capture rate of neutrons.  This increase in capture rate will naturally arrest a modest increase in power and bring the system into steady-state at a naturally-attained equilibrium temperature.  The same sequence will happen in the opposite direction for a decreasing neutron population.  A second stabilizing effect occurs when, as in the case of modern commercial reactors, the coolant serves double-duty as the moderator.  As temperature increases, the moderator density decreases, often leading decrease in the thermalization of neutrons.

We now see that obtaining a ``real'' steady-state solution would require solving not just the transport equation, but heat transfer and likely fluid dynamics equations as well.  Moreover introducing temperature (and density) as variables leads to nonlinearities in the transport equation.  In short, the not-so-simple transport equation just become orders of magnitude more challenging to solve.  So instead, how about we hold temperature constant (say at an average value), then solve the transport equation approximately by scaling fission to account for the fact that we are neglecting stabilizing feedback mechanisms.  The eigenvalue approach should look quite appealing at this point!

\subsection{Solving the Transport Equation}
\label{sec:orgheadline9}
Finding a closed-form solution of the transport equation is impossible for all but the simplest of cases.  In practice we must adopt both physical and numerical approximations.  Following is a partial list of complications we should expect.
\begin{enumerate}
\item Most mathematical theory deals with either partial differential equations \emph{or} integral equations.  The transport equation is an \emph{integro-differential} equation containing both an integral and gradient term.
\item The dimensionality of the phase space is quite high.  Three dimensions in space, two in angle, one in energy and one in time leads to a seven-dimensional space in the most general setting.  Numerically this will generate a very large number of unknowns that must be solved.
\item The energy dependence of the cross sections is very complex because of resonances.  Representing these cross sections numerically a very large number of discretization points.
\item The size of virtually all reactors is much greater than the neutron mean-free-path.  Thus any spatial discretization must include a large number of points.
\end{enumerate}

On the other hand, the transport equation is linear, so if we can manage the \emph{size} of the problem then we shouldn't loose too much sleep.  Given advances in modern computing, we are able to calculate much larger and more accurate transport solutions than ever before.  Nevertheless, solving large transport problems is very challenging.  Our goal presently is not to explore the computational approaches to this problem in any significant detail, but rather present an overview of the approximations and strategies that are made to solve neutron transport for reactor physics analyses.

\section{The Multigroup Approximation}
\label{sec:orgheadline11}
In the previous section we examined the behavior of neutrons with respect to the energy variable.  The neutron balance equation we derived there was actually the transport equation for an infinitely large, homogeneous region.  Under those conditions, \(\nabla\psi = \vec{0}\), and the flux did not depend on angle because of rotational symmetry.  We will now introduce an approximation that will lead to a simpler energy landscape so that we can devote more attention to spatial variations of the neutron flux.

The \emph{multigroup approximation} attempts to simplify the energy-dependent description of neutron transport by binning neutrons to ``groups'' based on their energy.  To begin, pick a set of energy group boundaries, 
\begin{align}
  E_G < E_{G-1} < E_{G-2} < \hdots < E_g < \hdots < E_2 < E_1 < E_0.
\end{align}
Note that (for historical reasons) \(E_0\) is the highest energy, while \(E_G\) is the lowest energy.  Energy group \(g\) is defined by the interval \([E_g, E_{g-1}]\).  

Next, integrate the transport equation over a single energy group.  We may use any of variant of the transport equation.  Going with the eigenvalue form [Eq. \eqref{eq::eigTransportEqn}] produces an equation that can be written
\begin{align}
  \vec{\Omega} \cdot \nabla \psi_g(\vec{r},\vec{\Omega})
  + \Sigma_g(\vec{r}) \psi_g(\vec{r},\vec{\Omega})
  &= \sum_{g'=1}^G \int_{4\pi} \Sigma_{g'\rightarrow g}(\vec{r}, \vec{\Omega}'\cdot\vec{\Omega}) \psi_g'(\vec{r},\vec{\Omega}') d\vec{\Omega}'\\
  &+ \lambda\frac{\chi_g}{4\pi} \sum_{g'=1}^G \int_{4\pi} \nu\Sigma_{f,g'}(\vec{r}) \psi_g'(\vec{r},\vec{\Omega}') d\vec{\Omega}'.
  \label{eq::mgTransportEqn}
\end{align}
where we have defined
\begin{align}
  \psi_g(\vec{r},\vec{\Omega}) &= \int_{E_g}^{E_g} dE \psi(\vec{r},\vec{\Omega},E), \\
  \Sigma_g(\vec{r}) &= \frac{\int_{E_g}^{E_g} dE \Sigma(\vec{r},E) \psi(\vec{r},\vec{\Omega},E)}{\int_{E_g}^{E_g} dE \psi(\vec{r},\vec{\Omega},E)}, \\
  \nu\Sigma_{f,g}(\vec{r}) &= \frac{\int_{E_g}^{E_g} dE \nu\Sigma_f(\vec{r},E) \psi(\vec{r},\vec{\Omega},E)}{\int_{E_g}^{E_g} dE \psi(\vec{r},\vec{\Omega},E)}, \\
  \chi_g &=  \int_{E_g}^{E_g} dE \chi(E), \\
  \Sigma_{g'\rightarrow g}(\vec{r}, \vec{\Omega}'\cdot\vec{\Omega} &= 
    \frac{\int_{E_g}^{E_g} dE \int_{E_{g'}}^{E_{g'}} dE' \Sigma_s(\vec{r},E' \rightarrow E, \vec{\Omega}'\cdot\vec{\Omega}) \psi(\vec{r},\vec{\Omega},E)}{\int_{E_g}^{E_g} dE \psi(\vec{r},\vec{\Omega},E)}.
\end{align}
The above parameters are called the multigroup constants and Eq. \eqref{eq::mgTransportEqn} the multigroup transport equation.  

The benefit of the multigroup equation is that \emph{if} we can calculate the multigroup constants, we can obtain a flux solution by solving the \(G\) coupled group equations for \(\psi_g\) rather than the transport equation that depends continuously on energy.  If \(G\) is chosen to be smaller than the number of points required to represent the most complex cross section (which is often in thousands), then we have simplified the computational task of solving the transport equation.  In practice, \(G\) may be be as large as a few hundred to as few as two.

Of course there is a catch-22 in that we need the detailed flux spectrum, \(\psi(\vec{r},\vec{\Omega},E)\), to calculate the group constants, but if we had the detailed flux spectrum then we could immediately calculate the group fluxes!  This is where an approximation is leveraged to maximize accuracy in the energy variable at the expense of the spatial variable.  Because most reactors feature regular arrays of fuel rods, symmetry can be used to simplify the transport problem.  Often a reactor physics calculations begins by solving the transport equation with 100's or 1000's of energy grid points in an infinite medium (0D), infinitely tall cylinder (1D) or occasionally a square pin-cell (2D).  Reflective boundary conditions around the simplified problem introduce an approximation, but if the neutron spectrum changes slowly with respect to space then the approximation is reasonable because the spectrum is only used as a weighting function to generate the multigroup cross sections.  In the past when computing power was scarce, the spectrum was obtained not by solving the transport equation, but simply by gluing a fission spectrum, a \(1/E\) intermediate spectrum and a thermal spectrum together.

Once an appropriate spectrum has been used to generate the multigroup constants, one may attempt to solve the transport equation for more complex geometries because the burden of excessive energy complexity has been lightened.  A single assembly calculation may use tens to a few hundred energy groups; a full-core calculation may use as few as two energy groups.

\section{Numerical Solutions of the Mutligroup Equation}
\label{sec:orgheadline14}
The multigroup approximation effectively handles the energy dependence of the transport equation (given a suitably accurate weighting spectrum for the cross section collapsing.)  There are several ways to discretize the equation with respect to angle.  In what follows we will look at the spherical harmonics (or \(P_N\)) and discrete ordinates (or \(S_N\)) approaches.  For simplicity our discussion will be limited to one spatial dimension.  Adopting the \(z\) direction (aligned with the \(\vec{k}\) unit direction) as the dimension of choice, the multigroup transport equation becomes
\begin{align}
  \mu \frac{\partial \psi_g(z,\mu)}{\partial z}
  + \Sigma_g(z) \psi_g(z,\mu)
  &= \sum_{g'=1}^G \int_{-1}^1 \Sigma_{g'\rightarrow g}(z, \mu_0) \psi_g'(z,\mu') d\mu' \\
  &+ \lambda\frac{\chi_g}{2} \sum_{g'=1}^G \int_{-1}^1 \nu\Sigma_{f,g'}(z) \psi_g'(z,\mu') d\mu'.
  \label{eq::1dMgTransportEqn}
\end{align}
Note that in obtaining this equation we have set \(\frac{\partial \psi}{\partial x} = \frac{\partial \psi}{\partial y} = 0\), integrated over all azimuthal angles, and set \(\mu=\cos\theta\) where \(\theta \in [0,\pi]\) is the polar angle.  We have additionally defined \(\mu_0 = \vec{\Omega}\cdot\vec{\Omega}' = \cos\theta_0\) as the cosine of the scattering deflection angle.

Before presenting the angular treatment of the transport equation, let's first consider a practical treatment of of the scattering cross section angular dependence.  As discussed in the appendix, the Legendre polynomials provide a basis for representing functions defined on the interval \([-1,1]\).  Because \(\theta_0 \in [0,\pi]\), the scattering cross section is just such a function when the position and group indices are fixed.  Specifically, let
\begin{align}
  \Sigma_{g'\rightarrow g}(z, \mu_0) = \sum_{\ell=0}^\infty \Sigma_{g' \rightarrow g}^\ell(z) P_\ell(\mu_0)
\end{align}
where \(P_\ell(\mu_0)\) is the \(\ell^\text{th}\) Legendre polynomial.  Multiplying this equation by \(P_{\ell'}(\mu_0)\), integrating over \(\mu_0\), and applying the orthogonality relationship leads to
\begin{align}
  \Sigma_{g' \rightarrow g}^\ell(z) = \frac{2\ell+1}{2} \int_{-1}^1 P_{\ell}(\mu_0)\Sigma_{g'\rightarrow g}(z, \mu_0) d\mu_0.
\end{align}
The \(\Sigma_{g' \rightarrow g}^\ell(z)\) coefficients are called the scattering moments.

Inserting the scattering kernel expansion into the transport equation provides
\begin{align}
  \mu \frac{\partial \psi_g(z,\mu)}{\partial z}
  + \Sigma_g(z) \psi_g(z,\mu)
  &= \sum_{g'=1}^G \sum_{\ell=0}^\infty \int_{-1}^1 \Sigma_{g' \rightarrow g}^\ell(z) P_\ell(\mu_0) \psi_g'(z,\mu') d\mu' \\
  &+ \lambda\frac{\chi_g}{2} \sum_{g'=1}^G \int_{-1}^1 \nu\Sigma_{f,g'}(z) \psi_g'(z,\mu') d\mu'.
\end{align}
Using the addition theorem of Legendre polynomials allows us to write the polynomial \(\mu_0\) as the product of polynomials in \(\mu\) and \(\mu'\):
\begin{align}
  \mu \frac{\partial \psi_g(z,\mu)}{\partial z}
  + \Sigma_g(z) \psi_g(z,\mu)
  &= \sum_{g'=1}^G \sum_{\ell=0}^\infty \Sigma_{g' \rightarrow g}^\ell(z) P_\ell(\mu) \int_{-1}^1 P_\ell(\mu') \psi_g'(z,\mu') d\mu' \\
  &+ \lambda\frac{\chi_g}{2} \sum_{g'=1}^G \int_{-1}^1 \nu\Sigma_{f,g'}(z) \psi_g'(z,\mu') d\mu'.
\end{align}

\subsection{The Spherical Harmonics Method}
\label{sec:orgheadline12}
The spherical harmonics are a set of functions that provide a basis for representing functions that exist on a spherical surface.  Given that the unit direction \(\vec{\Omega}\) sweeps out the surface a sphere, they can be used as a basis for representing the angular dependence of the neutron flux in three dimensions.  In one dimension, the spherical harmonics can be integrated down to the Legendre polynomials, which provide a polynomial basis for functions defined on the interval \([-1,1]\).  The angular flux in one spatial dimension is a function of the cosine \(\mu\), which takes values between -1 and 1; thus the \$\(\mu\)\$-dependence of the angular flux may be represented by a Legendre polynomial expansion.

Specifically, let
\begin{align}
  \psi_g(z,\mu) = \sum_{n=0}^\infty \psi_{g,n}(z) P_n(\mu).
\end{align}
Orthogonality of the polynomials reveals that
\begin{align}
  \psi_{g,n}(z) = \frac{2n+1}{2} \int_{-1}^1 \psi_g(z,\mu) P_n(\mu).
\end{align}

Now insert the flux expansion\ldots{}

\subsection{The Discrete Ordinates Method}
\label{sec:orgheadline13}

\section{The Diffusion Approximation}
\label{sec:orgheadline15}
\section{Problems}
\label{sec:orgheadline16}
\end{document}